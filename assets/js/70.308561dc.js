(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{195:function(s,a,t){"use strict";t.r(a);var e=t(0),n=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("div",{staticClass:"content"},[t("h1",{attrs:{id:"lamp-和-lnmp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lamp-和-lnmp","aria-hidden":"true"}},[s._v("#")]),s._v(" LAMP 和 LNMP")]),s._v(" "),t("h2",{attrs:{id:"php-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#php-安装","aria-hidden":"true"}},[s._v("#")]),s._v(" php 安装")]),s._v(" "),t("p",[s._v("1：默认版本太低（5.4） 升级php 到5.6")]),s._v(" "),t("p",[s._v("1.1 检查当前安装的PHP包")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum list installed "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token function"}},[s._v("grep")]),s._v(" php\n")])])]),t("p",[s._v("1.2如果有安装的PHP包，先删除他们")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum remove php.x86_64 php-cli.x86_64 php-common.x86_64 php-gd.x86_64 php-ldap.x86_64 php-mbstring.x86_64 php-mcrypt.x86_64 php-mysql.x86_64 php-pdo.x86_64\n")])])]),t("p",[s._v("2 ： 配置源")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" rpm -Uvh http://mirror.webtatic.com/yum/el7/epel-release.rpm\n"),t("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" rpm -Uvh http://mirror.webtatic.com/yum/el7/webtatic-release.rpm\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 如果想删除上面安装的包，重新安装  ")]),s._v("\nrpm -qa "),t("span",{attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{attrs:{class:"token function"}},[s._v("grep")]),s._v(" webstatic\nrpm -e  "),t("span",{attrs:{class:"token comment"}},[s._v("# 上面搜索到的包即可")]),s._v("\n")])])]),t("p",[s._v("3：fpm 安装 和 基本操作")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token comment"}},[s._v("# 也可以php55w-fpm  php70w-fpm")]),s._v("\n"),t("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{attrs:{class:"token function"}},[s._v("install")]),s._v(" php56w-fpm \n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 启动/重启/停止服务")]),s._v("\n"),t("span",{attrs:{class:"token function"}},[s._v("service")]),s._v(" php-fpm start/restart/stop\n")])])]),t("p",[s._v("4：安装PHP扩展")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{attrs:{class:"token function"}},[s._v("install")]),s._v(" php56w.x86_64 php56w-cli.x86_64 php56w-common.x86_64 php56w-gd.x86_64 php56w-mbstring.x86_64 php56w-mcrypt.x86_64 php56w-mysql.x86_64 php56w-pdo.x86_64\n")])])]),t("h2",{attrs:{id:"apache-基本操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#apache-基本操作","aria-hidden":"true"}},[s._v("#")]),s._v(" Apache 基本操作")]),s._v(" "),t("ul",[t("li",[s._v("yum install httpd 安装服务")]),s._v(" "),t("li",[s._v("service httpd start 启动服务")]),s._v(" "),t("li",[s._v("service httpd stop 停止服务")])]),s._v(" "),t("h2",{attrs:{id:"apache-虚拟主机和伪静态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#apache-虚拟主机和伪静态","aria-hidden":"true"}},[s._v("#")]),s._v(" Apache 虚拟主机和伪静态")]),s._v(" "),t("ul",[t("li",[s._v("/etc/sysconfig/setlinux 将"),t("code",[s._v("SETLINUX=enforcing")]),s._v("改为"),t("code",[s._v("SETLINUX=disabled")])]),s._v(" "),t("li",[s._v("配置 Apache 虚拟主机示例，重启 Apache 服务")])]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('<VirtualHost *:80>\n  ServerName test.com\n  DocumentRoot /data/www\n  <Directory "/data/www">\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Require all granted\n    <IfModule mod_rewrite.c>\n      RewriteEngine On\n      RewriteRule ^(.*)\\.htm$ index.html\n    </IfWrite>\n  </Directory>\n</VirtualHost>\n')])])]),t("h2",{attrs:{id:"nginx-基本操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-基本操作","aria-hidden":"true"}},[s._v("#")]),s._v(" nginx 基本操作")]),s._v(" "),t("ul",[t("li",[s._v("yum install nginx # 安装")]),s._v(" "),t("li",[s._v("service nginx start # 启动")]),s._v(" "),t("li",[s._v("service nginx stop # 停止")]),s._v(" "),t("li",[s._v("service nginx reload # 重启")])]),s._v(" "),t("h2",{attrs:{id:"nginx-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-安装","aria-hidden":"true"}},[s._v("#")]),s._v(" nginx 安装")]),s._v(" "),t("ul",[t("li",[s._v("sudo rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm")]),s._v(" "),t("li",[s._v("sudo yum install nginx")])]),s._v(" "),t("h2",{attrs:{id:"伪静态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#伪静态","aria-hidden":"true"}},[s._v("#")]),s._v(" 伪静态")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("location / {\n  rewrite ^(.*)\\.htm$ /index.html;\n}\n")])])]),t("h2",{attrs:{id:"日志格式化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#日志格式化","aria-hidden":"true"}},[s._v("#")]),s._v(" 日志格式化")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('log_format  main  \'$remote_addr - $remote_user [$time_local] "$request" \'\n  \'$status $body_bytes_sent "$http_referer" \'\n  \'"$http_user_agent" "$http_x_forwarded_for"\';\n\naccess_log  /var/log/nginx/access.log  main;\n')])])]),t("h2",{attrs:{id:"反向代理和负载均衡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#反向代理和负载均衡","aria-hidden":"true"}},[s._v("#")]),s._v(" 反向代理和负载均衡")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("upstream test_hosts {\n  server 118.89.106.129:80;\n  server 122.114.250.244:8082;\n}\n\nserver {\n    listen       80;\n    server_name  www.imooc.test;\n\n    location / {\n      proxy_pass http://test_hosts;\n    }\n}\n\n")])])]),t("h2",{attrs:{id:"nginx-php-通用配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx-php-通用配置","aria-hidden":"true"}},[s._v("#")]),s._v(" nginx PHP 通用配置")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("server {\n  listen       80;\n  server_name  tp.com;\n  \n  root /data/www/tp/public;\n  index index.php index.html;\n  \n  access_log /var/log/nginx/access_tp.log main;\n\n  location / {\n    try_files $uri $uri/ /index.php?$args;\n  }\n\n  location ~ \\.php$ {\n    include fastcgi_params;\n    fastcgi_pass 127.0.0.1:9000;\n    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n    try_files $uri =404;\n  }   \n}\n\n")])])]),t("h2",{attrs:{id:"调试功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#调试功能","aria-hidden":"true"}},[s._v("#")]),s._v(" 调试功能")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('add_header Content-Type "text/plain;charset=utf-8";\nreturn 200 "$http_host"\n')])])]),t("h2",{attrs:{id:"mysql-基本操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql-基本操作","aria-hidden":"true"}},[s._v("#")]),s._v(" mysql 基本操作")]),s._v(" "),t("ul",[t("li",[s._v("yum install mysql-community-server 安装")]),s._v(" "),t("li",[s._v("yum mysqld start/restart 启动")]),s._v(" "),t("li",[s._v("yum mysqld stop 停止")])]),s._v(" "),t("h2",{attrs:{id:"mysql-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql-安装","aria-hidden":"true"}},[s._v("#")]),s._v(" mysql 安装")]),s._v(" "),t("ul",[t("li",[s._v("CentOS7 默认安装 mariadb 数据库")]),s._v(" "),t("li",[s._v("yum remove mariadb-libs.x86_64")]),s._v(" "),t("li",[s._v("https://dev.mysql.com.downloads/repo/yum/ 下载 mysql 源")]),s._v(" "),t("li",[s._v("yum localinstall mysql57-community-release-el7-8.noarch.rpm")]),s._v(" "),t("li",[s._v("yum install mysql-community-server 安装 mysql")]),s._v(" "),t("li",[s._v('cat /var/log/mysqld/.log | grep "password" 查看默认密码')]),s._v(" "),t("li",[s._v("mysql -uroot -pxxx 登陆 mysql 控制台")])]),s._v(" "),t("p",[t("strong",[s._v("初次登陆控制台，无论输入什么命令都会提示重置密码")])]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token comment"}},[s._v("# 设置密码为 123456")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("set")]),s._v(" password "),t("span",{attrs:{class:"token operator"}},[s._v("=")]),s._v(" password"),t("span",{attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{attrs:{class:"token string"}},[s._v("'123456'")]),t("span",{attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 设置密码校验规则")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("global")]),s._v(" validate_password_policy"),t("span",{attrs:{class:"token operator"}},[s._v("=")]),t("span",{attrs:{class:"token number"}},[s._v("0")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("global")]),s._v(" validate_password_length"),t("span",{attrs:{class:"token operator"}},[s._v("=")]),t("span",{attrs:{class:"token number"}},[s._v("1")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("mysql 8.0.11  初始化密码使用，上面的方式不适用于 8.0.11 版本的 mysql")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'root'")]),s._v("@'localhost"),t("span",{attrs:{class:"token string"}},[s._v("' IDENTIFIED BY '")]),s._v("MyNewPass'"),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"general-log-日志开启"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#general-log-日志开启","aria-hidden":"true"}},[s._v("#")]),s._v(" general_log 日志开启")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token comment"}},[s._v("# 设置 general_log 文件存放位置")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("global")]),s._v(" general_log_file"),t("span",{attrs:{class:"token operator"}},[s._v("=")]),t("span",{attrs:{class:"token string"}},[s._v('"/tmp/general.log"')]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 开启 general_log")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("global")]),s._v(" general_log"),t("span",{attrs:{class:"token operator"}},[s._v("=")]),t("span",{attrs:{class:"token keyword"}},[s._v("on")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 关闭 general_log")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("global")]),s._v(" general_log"),t("span",{attrs:{class:"token operator"}},[s._v("=")]),t("span",{attrs:{class:"token keyword"}},[s._v("off")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"用户操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户操作","aria-hidden":"true"}},[s._v("#")]),s._v(" 用户操作")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{attrs:{class:"token comment"}},[s._v("# 创建用户")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),t("span",{attrs:{class:"token string"}},[s._v("'user'")]),s._v("@'"),t("span",{attrs:{class:"token operator"}},[s._v("%")]),t("span",{attrs:{class:"token string"}},[s._v("' identified by '")]),s._v("password"),t("span",{attrs:{class:"token string"}},[s._v("';\n\n# 给 user 用户赋予所有数据库的所有表的增删改查权限\ngrant all privileges on *.* to '")]),t("span",{attrs:{class:"token keyword"}},[s._v("user")]),t("span",{attrs:{class:"token string"}},[s._v("'@'")]),t("span",{attrs:{class:"token operator"}},[s._v("%")]),t("span",{attrs:{class:"token string"}},[s._v("' identified by '")]),s._v("password' "),t("span",{attrs:{class:"token keyword"}},[s._v("with")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("grant")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("option")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{attrs:{class:"token comment"}},[s._v("# 移除用户 user 的权限")]),s._v("\n"),t("span",{attrs:{class:"token keyword"}},[s._v("revoke")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("all")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("privileges")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("on")]),s._v(" "),t("span",{attrs:{class:"token operator"}},[s._v("*")]),t("span",{attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{attrs:{class:"token keyword"}},[s._v("user")]),t("span",{attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h2",{attrs:{id:"免密码登陆"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#免密码登陆","aria-hidden":"true"}},[s._v("#")]),s._v(" 免密码登陆")]),s._v(" "),t("ul",[t("li",[s._v("/etc/my.cnf 加入一行"),t("code",[s._v("skip-grant-tables")]),s._v("，重启 mysqld 服务")])])])}],!1,null,null,null);n.options.__file="lamp-and-lnmp.md";a.default=n.exports}}]);