{"remainingRequest":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/index.js??ref--1-1!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vuepress/lib/webpack/markdownLoader.js??ref--1-2!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/docs/swoft-up/operate.md?vue&type=template&id=9c35f66a&","dependencies":[{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/docs/swoft-up/operate.md","mtime":1543560895394},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/cache-loader/dist/cjs.js","mtime":1543560896208},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/loaders/templateLoader.js","mtime":1543560898798},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/cache-loader/dist/cjs.js","mtime":1543560896208},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/index.js","mtime":1543560898797},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vuepress/lib/webpack/markdownLoader.js","mtime":1543560898911}],"contextDependencies":[],"result":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content\"},[_vm._ssrNode(\"<h1 id=\\\"概念实操\\\"><a href=\\\"#概念实操\\\" aria-hidden=\\\"true\\\" class=\\\"header-anchor\\\">#</a> 概念实操</h1> <h2 id=\\\"注解\\\"><a href=\\\"#注解\\\" aria-hidden=\\\"true\\\" class=\\\"header-anchor\\\">#</a> 注解</h2> <p>PHP没有注解，但是可以利用反射来读取类或方法上的注释内容</p> <div class=\\\"language-php extra-class\\\"><pre class=\\\"language-php\\\"><code>\\n<span class=\\\"token comment\\\">/**\\n * \\n */</span>\\n\\n</code></pre></div>\"),_vm._ssrNode(\"<p>\",\"</p>\",[_vm._ssrNode(\"<a href=\\\"http://php.net/manual/zh/reflectionclass.getdoccomment.php\\\" target=\\\"_blank\\\" rel=\\\"noopener noreferrer\\\">\",\"</a>\",[_vm._ssrNode(\"PHP反射\"),_c('OutboundLink')],2)]),_vm._ssrNode(\" <h2 id=\\\"控制器\\\"><a href=\\\"#控制器\\\" aria-hidden=\\\"true\\\" class=\\\"header-anchor\\\">#</a> 控制器</h2> <div class=\\\"language-php extra-class\\\"><pre class=\\\"language-php\\\"><code>\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Controllers</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Controller</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMapping</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMethod</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Controller(prefix=&quot;/users&quot;)\\n */</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">UsersController</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">/**\\n     * @RequestMapping(route=&quot;/test&quot;, method=RequestMethod::POST)\\n     * @return String\\n     */</span>\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">test</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token single-quoted-string string\\\">'Hello World'</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n</code></pre></div><h2 id=\\\"实体\\\"><a href=\\\"#实体\\\" aria-hidden=\\\"true\\\" class=\\\"header-anchor\\\">#</a> 实体</h2> <div class=\\\"language-bash extra-class\\\"><pre class=\\\"language-bash\\\"><code>\\n<span class=\\\"token comment\\\"># 源码安装执行命令</span>\\nphp bin/swoft entity:create -d <span class=\\\"token function\\\">test</span> -i user\\n\\n<span class=\\\"token comment\\\"># docker环境下执行命令</span>\\ndocker <span class=\\\"token function\\\">exec</span> -it swoft php bin/swoft entity:create -d <span class=\\\"token function\\\">test</span> -i user\\n\\n</code></pre></div><h2 id=\\\"bean容器\\\"><a href=\\\"#bean容器\\\" aria-hidden=\\\"true\\\" class=\\\"header-anchor\\\">#</a> Bean容器</h2> <ol><li>常规写法</li></ol> <div class=\\\"language-php extra-class\\\"><pre class=\\\"language-php\\\"><code>\\n<span class=\\\"token comment\\\">///////////////////////////////////////////////////////////</span>\\n\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Models<span class=\\\"token punctuation\\\">\\\\</span>Entity<span class=\\\"token punctuation\\\">\\\\</span>Products</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ProdFilter</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">public</span>  <span class=\\\"token variable\\\">$discount</span><span class=\\\"token operator\\\">=</span><span class=\\\"token number\\\">0.8</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// 商品折扣</span>\\n\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">filter</span><span class=\\\"token punctuation\\\">(</span>Products <span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span><span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token variable\\\">$price</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token variable\\\">$products</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">getPrice</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>      \\n        <span class=\\\"token variable\\\">$products</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">setPrice</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$price</span><span class=\\\"token operator\\\">*</span><span class=\\\"token variable\\\">$this</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token property\\\">discount</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\">///////////////////////////////////////////////////////////</span>\\n\\n<span class=\\\"token shell-comment comment\\\"># 控制器</span>\\n\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Controllers</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test<span class=\\\"token punctuation\\\">\\\\</span>ProdFilter</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Db<span class=\\\"token punctuation\\\">\\\\</span>Query</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Message<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Request</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Controller</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMapping</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMethod</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Controller(prefix=&quot;/prod&quot;)\\n */</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ProdController</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">/**\\n     * @RequestMapping(route=&quot;/prod/{pid}&quot;, method=RequestMethod::GET)\\n     */</span>\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">getUserDetail</span><span class=\\\"token punctuation\\\">(</span>int <span class=\\\"token variable\\\">$pid</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n    \\t<span class=\\\"token variable\\\">$pf</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token keyword\\\">new</span> <span class=\\\"token class-name\\\">ProdFilter</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token variable\\\">$pf</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">filter</span><span class=\\\"token punctuation\\\">(</span>Products<span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token function\\\">findById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$pid</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">getResult</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n</code></pre></div><ol start=\\\"2\\\"><li>bean容器</li></ol> <div class=\\\"language-php extra-class\\\"><pre class=\\\"language-php\\\"><code>\\n<span class=\\\"token comment\\\">///////////////////////////////////////////////////////////</span>\\n\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Models<span class=\\\"token punctuation\\\">\\\\</span>Entity<span class=\\\"token punctuation\\\">\\\\</span>Products</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\"><span class=\\\"token punctuation\\\">\\\\</span>Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Bean</span><span class=\\\"token punctuation\\\">;</span>    <span class=\\\"token comment\\\">// 引入bean命名空间</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Bean(&quot;ProdFilter&quot;)           // 定义bean别名\\n */</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ProdFilter</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">public</span>  <span class=\\\"token variable\\\">$discount</span><span class=\\\"token operator\\\">=</span><span class=\\\"token number\\\">0.8</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// 商品折扣</span>\\n\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">filter</span><span class=\\\"token punctuation\\\">(</span>Products <span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span><span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token variable\\\">$price</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token variable\\\">$products</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">getPrice</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>      \\n        <span class=\\\"token variable\\\">$products</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">setPrice</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$price</span><span class=\\\"token operator\\\">*</span><span class=\\\"token variable\\\">$this</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token property\\\">discount</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\">///////////////////////////////////////////////////////////</span>\\n\\n<span class=\\\"token shell-comment comment\\\"># 控制器</span>\\n\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Controllers</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test<span class=\\\"token punctuation\\\">\\\\</span>ProdFilter</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>BeanFactory</span><span class=\\\"token punctuation\\\">;</span>             <span class=\\\"token comment\\\">// 引入bean</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Db<span class=\\\"token punctuation\\\">\\\\</span>Query</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Message<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Request</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Controller</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMapping</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMethod</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Controller(prefix=&quot;/prod&quot;)\\n */</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ProdController</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">/**\\n     * @RequestMapping(route=&quot;/prod/{pid}&quot;, method=RequestMethod::GET)\\n     */</span>\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">getUserDetail</span><span class=\\\"token punctuation\\\">(</span>int <span class=\\\"token variable\\\">$pid</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n    \\t<span class=\\\"token variable\\\">$pf</span> <span class=\\\"token operator\\\">=</span> BeanFactory<span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token function\\\">getBean</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token single-quoted-string string\\\">'ProdFilter'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>        <span class=\\\"token comment\\\">// 获取bean</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token variable\\\">$pf</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">filter</span><span class=\\\"token punctuation\\\">(</span>Products<span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token function\\\">findById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$pid</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">getResult</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n</code></pre></div><ol start=\\\"3\\\"><li>通过注解引入</li></ol> <div class=\\\"language-php extra-class\\\"><pre class=\\\"language-php\\\"><code>\\n<span class=\\\"token comment\\\">///////////////////////////////////////////////////////////</span>\\n\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Models<span class=\\\"token punctuation\\\">\\\\</span>Entity<span class=\\\"token punctuation\\\">\\\\</span>Products</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\"><span class=\\\"token punctuation\\\">\\\\</span>Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Bean</span><span class=\\\"token punctuation\\\">;</span>    <span class=\\\"token comment\\\">// 引入bean命名空间</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Bean(&quot;ProdFilter&quot;)           // 定义bean别名\\n */</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ProdFilter</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">public</span>  <span class=\\\"token variable\\\">$discount</span><span class=\\\"token operator\\\">=</span><span class=\\\"token number\\\">0.8</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// 商品折扣</span>\\n\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">filter</span><span class=\\\"token punctuation\\\">(</span>Products <span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span><span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token variable\\\">$price</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token variable\\\">$products</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">getPrice</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>      \\n        <span class=\\\"token variable\\\">$products</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">setPrice</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$price</span><span class=\\\"token operator\\\">*</span><span class=\\\"token variable\\\">$this</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token property\\\">discount</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\">///////////////////////////////////////////////////////////</span>\\n\\n<span class=\\\"token shell-comment comment\\\"># 控制器</span>\\n\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Controllers</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test<span class=\\\"token punctuation\\\">\\\\</span>ProdFilter</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\"><span class=\\\"token punctuation\\\">\\\\</span>Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Inject</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// 引入bean注解</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Db<span class=\\\"token punctuation\\\">\\\\</span>Query</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Message<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Request</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Controller</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMapping</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMethod</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Controller(prefix=&quot;/prod&quot;)\\n */</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ProdController</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">/**\\n\\t * @Inject(name=&quot;ProdFilter&quot;)\\n\\t */</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token variable\\\">$pf</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token comment\\\">/**\\n     * @RequestMapping(route=&quot;/prod/{pid}&quot;, method=RequestMethod::GET)\\n     */</span>\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">getUserDetail</span><span class=\\\"token punctuation\\\">(</span>int <span class=\\\"token variable\\\">$pid</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token variable\\\">$pf</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">filter</span><span class=\\\"token punctuation\\\">(</span>Products<span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token function\\\">findById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$pid</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">getResult</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n</code></pre></div><ol start=\\\"4\\\"><li>调优</li></ol> <div class=\\\"language-php extra-class\\\"><pre class=\\\"language-php\\\"><code>\\n<span class=\\\"token comment\\\">///////////////////////////////////////////////////////////</span>\\n\\n<span class=\\\"token comment\\\">// 新增配置过滤类</span>\\n\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\"><span class=\\\"token punctuation\\\">\\\\</span>Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Bean</span><span class=\\\"token punctuation\\\">;</span>    <span class=\\\"token comment\\\">// 引入bean命名空间</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Bean(&quot;FilterConfig&quot;)           // 定义bean别名\\n */</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">FilterConfig</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token keyword\\\">public</span>  <span class=\\\"token variable\\\">$discount</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token number\\\">0.8</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// 商品折扣</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\">///////////////////////////////////////////////////////////</span>\\n\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Models<span class=\\\"token punctuation\\\">\\\\</span>Entity<span class=\\\"token punctuation\\\">\\\\</span>Products</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\"><span class=\\\"token punctuation\\\">\\\\</span>Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Bean</span><span class=\\\"token punctuation\\\">;</span>    <span class=\\\"token comment\\\">// 引入bean命名空间</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\"><span class=\\\"token punctuation\\\">\\\\</span>Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Inject</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// 引入bean注解</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Bean(&quot;ProdFilter&quot;)           // 定义bean别名\\n */</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ProdFilter</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n    <span class=\\\"token comment\\\">/**\\n\\t * @Inject(name=&quot;FilterConfig&quot;)\\n\\t */</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token variable\\\">$filterConfig</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">filter</span><span class=\\\"token punctuation\\\">(</span>Products <span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">if</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token operator\\\">!</span><span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">return</span> <span class=\\\"token keyword\\\">null</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token variable\\\">$price</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token variable\\\">$products</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">getPrice</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>      \\n        <span class=\\\"token variable\\\">$products</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">setPrice</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$price</span><span class=\\\"token operator\\\">*</span><span class=\\\"token variable\\\">$this</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token property\\\">filterConfig</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token property\\\">discount</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token variable\\\">$products</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\">///////////////////////////////////////////////////////////</span>\\n\\n<span class=\\\"token shell-comment comment\\\"># 控制器</span>\\n\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Controllers</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test<span class=\\\"token punctuation\\\">\\\\</span>ProdFilter</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\"><span class=\\\"token punctuation\\\">\\\\</span>Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Inject</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// 引入bean注解</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Db<span class=\\\"token punctuation\\\">\\\\</span>Query</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Message<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Request</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Controller</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMapping</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMethod</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Controller(prefix=&quot;/prod&quot;)\\n */</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ProdController</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">/**\\n\\t * @Inject(name=&quot;ProdFilter&quot;)\\n\\t */</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token variable\\\">$pf</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token comment\\\">/**\\n     * @RequestMapping(route=&quot;/prod/{pid}&quot;, method=RequestMethod::GET)\\n     */</span>\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">getUserDetail</span><span class=\\\"token punctuation\\\">(</span>int <span class=\\\"token variable\\\">$pid</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token variable\\\">$pf</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">filter</span><span class=\\\"token punctuation\\\">(</span>Products<span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token function\\\">findById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$pid</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">getResult</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n</code></pre></div><h2 id=\\\"value注解类\\\"><a href=\\\"#value注解类\\\" aria-hidden=\\\"true\\\" class=\\\"header-anchor\\\">#</a> Value注解类</h2> <div class=\\\"language-php extra-class\\\"><pre class=\\\"language-php\\\"><code>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\"><span class=\\\"token punctuation\\\">\\\\</span>Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Value</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// 引入Value注解</span>\\n\\n<span class=\\\"token comment\\\">/////////////////////////////////////////</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Value(name=&quot;${config.product.filterConfig.discount}&quot;)\\n */</span>\\n<span class=\\\"token keyword\\\">public</span> <span class=\\\"token variable\\\">$discount</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// 商品折扣</span>\\n\\n</code></pre></div><h2 id=\\\"中间件\\\"><a href=\\\"#中间件\\\" aria-hidden=\\\"true\\\" class=\\\"header-anchor\\\">#</a> 中间件</h2> <div class=\\\"language-php extra-class\\\"><pre class=\\\"language-php\\\"><code>\\n<span class=\\\"token comment\\\">//////////////////////////////////////////////////////////////</span>\\n\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Psr<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>RequestHandlerInterface</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Psr<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Message<span class=\\\"token punctuation\\\">\\\\</span>ResponseInterface</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Psr<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Message<span class=\\\"token punctuation\\\">\\\\</span>ServerRequestInterface</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Message<span class=\\\"token punctuation\\\">\\\\</span>Middleware<span class=\\\"token punctuation\\\">\\\\</span>MiddlewareInterface</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\"><span class=\\\"token punctuation\\\">\\\\</span>Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Bean</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Models<span class=\\\"token punctuation\\\">\\\\</span>Entity<span class=\\\"token punctuation\\\">\\\\</span>Products</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\"><span class=\\\"token punctuation\\\">\\\\</span>Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Inject</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Bean(&quot;ProdMiddWare&quot;) \\n */</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ProdMiddWare</span> <span class=\\\"token keyword\\\">implements</span> <span class=\\\"token class-name\\\">MiddlewareInterface</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">/**\\n\\t * @Inject(name=&quot;ProdFilter&quot;)\\n\\t */</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token variable\\\">$pf</span><span class=\\\"token punctuation\\\">;</span>\\n\\n\\t<span class=\\\"token comment\\\">/**\\n     * Process an incoming server request and return a response, optionally delegating\\n     * response creation to a handler.\\n     *\\n     * @param \\\\Psr\\\\Http\\\\Message\\\\ServerRequestInterface $request\\n     * @param \\\\Psr\\\\Http\\\\Server\\\\RequestHandlerInterface $handler\\n     * @return \\\\Psr\\\\Http\\\\Message\\\\ResponseInterface\\n     * @throws \\\\InvalidArgumentException\\n     */</span>\\n    <span class=\\\"token keyword\\\">public</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">process</span><span class=\\\"token punctuation\\\">(</span>ServerRequestInterface <span class=\\\"token variable\\\">$request</span><span class=\\\"token punctuation\\\">,</span> RequestHandlerInterface <span class=\\\"token variable\\\">$handler</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">:</span> ResponseInterface\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token variable\\\">$response</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token variable\\\">$handler</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">handle</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$request</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token variable\\\">$getAttr</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token variable\\\">$response</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">getAttribute</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token single-quoted-string string\\\">'responseAttribute'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$getAttr</span> <span class=\\\"token operator\\\">&amp;&amp;</span> <span class=\\\"token variable\\\">$getAttr</span> <span class=\\\"token keyword\\\">instanceof</span> <span class=\\\"token class-name\\\">Products</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span>\\n        \\t<span class=\\\"token variable\\\">$product</span> <span class=\\\"token operator\\\">=</span> <span class=\\\"token variable\\\">$this</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token property\\\">pf</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">filter</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$getAttr</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        \\t<span class=\\\"token keyword\\\">return</span> <span class=\\\"token variable\\\">$response</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">withAttribute</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token double-quoted-string string\\\">&quot;responseAttribute&quot;</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token variable\\\">$product</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n        <span class=\\\"token punctuation\\\">}</span>\\n        <span class=\\\"token keyword\\\">return</span> <span class=\\\"token variable\\\">$response</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">withAddedHeader</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token single-quoted-string string\\\">'Middleware-Action-Test'</span><span class=\\\"token punctuation\\\">,</span> <span class=\\\"token single-quoted-string string\\\">'success'</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n<span class=\\\"token comment\\\">///////////////////////////////////////////////////////////</span>\\n\\n<span class=\\\"token shell-comment comment\\\"># 控制器</span>\\n\\n<span class=\\\"token keyword\\\">namespace</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Controllers</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test<span class=\\\"token punctuation\\\">\\\\</span>ProdFilter</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\"><span class=\\\"token punctuation\\\">\\\\</span>Swoft<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Inject</span><span class=\\\"token punctuation\\\">;</span>  <span class=\\\"token comment\\\">// 引入bean注解</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Db<span class=\\\"token punctuation\\\">\\\\</span>Query</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Message<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Request</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Controller</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMapping</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Server<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>RequestMethod</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">Swoft<span class=\\\"token punctuation\\\">\\\\</span>Http<span class=\\\"token punctuation\\\">\\\\</span>Message<span class=\\\"token punctuation\\\">\\\\</span>Bean<span class=\\\"token punctuation\\\">\\\\</span>Annotation<span class=\\\"token punctuation\\\">\\\\</span>Middleware</span><span class=\\\"token punctuation\\\">;</span>\\n<span class=\\\"token keyword\\\">use</span> <span class=\\\"token package\\\">App<span class=\\\"token punctuation\\\">\\\\</span>Test<span class=\\\"token punctuation\\\">\\\\</span>ProdMiddWare</span><span class=\\\"token punctuation\\\">;</span>\\n\\n<span class=\\\"token comment\\\">/**\\n * @Controller(prefix=&quot;/prod&quot;)\\n * @Middleware(class=ProdMiddWare::class)\\n */</span>\\n<span class=\\\"token keyword\\\">class</span> <span class=\\\"token class-name\\\">ProdController</span>\\n<span class=\\\"token punctuation\\\">{</span>\\n\\t<span class=\\\"token comment\\\">/**\\n\\t * @Inject(name=&quot;ProdFilter&quot;)\\n\\t */</span>\\n\\t<span class=\\\"token keyword\\\">public</span> <span class=\\\"token variable\\\">$pf</span><span class=\\\"token punctuation\\\">;</span>\\n\\n    <span class=\\\"token comment\\\">/**\\n     * @RequestMapping(route=&quot;/prod/{pid}&quot;, method=RequestMethod::GET)\\n     */</span>\\n    <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">getUserDetail</span><span class=\\\"token punctuation\\\">(</span>int <span class=\\\"token variable\\\">$pid</span><span class=\\\"token punctuation\\\">)</span>\\n    <span class=\\\"token punctuation\\\">{</span>\\n        <span class=\\\"token keyword\\\">return</span> Products<span class=\\\"token punctuation\\\">:</span><span class=\\\"token punctuation\\\">:</span><span class=\\\"token function\\\">findById</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token variable\\\">$pid</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token operator\\\">-</span><span class=\\\"token operator\\\">&gt;</span><span class=\\\"token function\\\">getResult</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">;</span>\\n    <span class=\\\"token punctuation\\\">}</span>\\n<span class=\\\"token punctuation\\\">}</span>\\n\\n</code></pre></div>\")],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"]}