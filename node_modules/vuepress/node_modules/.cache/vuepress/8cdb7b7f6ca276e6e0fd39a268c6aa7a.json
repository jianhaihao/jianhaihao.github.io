{"remainingRequest":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/index.js??ref--1-1!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vuepress/lib/webpack/markdownLoader.js??ref--1-2!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/docs/linux/lamp-and-lnmp.md?vue&type=template&id=29825d8c&","dependencies":[{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/docs/linux/lamp-and-lnmp.md","mtime":1537944817438},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/cache-loader/dist/cjs.js","mtime":1537944818120},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/loaders/templateLoader.js","mtime":1537944820597},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/cache-loader/dist/cjs.js","mtime":1537944818120},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/index.js","mtime":1537944820597},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vuepress/lib/webpack/markdownLoader.js","mtime":1537944820671}],"contextDependencies":[],"result":["\n<div class=\"content\"><h1 id=\"lamp-和-lnmp\"><a class=\"header-anchor\" href=\"#lamp-和-lnmp\" aria-hidden=\"true\">#</a> LAMP 和 LNMP</h1>\n<h2 id=\"php-安装\"><a class=\"header-anchor\" href=\"#php-安装\" aria-hidden=\"true\">#</a> php 安装</h2>\n<p>1：默认版本太低（5.4） 升级php 到5.6</p>\n<p>1.1 检查当前安装的PHP包</p>\n<!--beforebegin--><div class=\"language-bash extra-class\"><!--afterbegin--><pre v-pre class=\"language-bash\"><code>yum list installed <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> php\n</code></pre>\n<!--beforeend--></div><!--afterend--><p>1.2如果有安装的PHP包，先删除他们</p>\n<!--beforebegin--><div class=\"language-bash extra-class\"><!--afterbegin--><pre v-pre class=\"language-bash\"><code>yum remove php.x86_64 php-cli.x86_64 php-common.x86_64 php-gd.x86_64 php-ldap.x86_64 php-mbstring.x86_64 php-mcrypt.x86_64 php-mysql.x86_64 php-pdo.x86_64\n</code></pre>\n<!--beforeend--></div><!--afterend--><p>2 ： 配置源</p>\n<!--beforebegin--><div class=\"language-bash extra-class\"><!--afterbegin--><pre v-pre class=\"language-bash\"><code><span class=\"token function\">sudo</span> rpm -Uvh http://mirror.webtatic.com/yum/el7/epel-release.rpm\n<span class=\"token function\">sudo</span> rpm -Uvh http://mirror.webtatic.com/yum/el7/webtatic-release.rpm\n\n<span class=\"token comment\"># 如果想删除上面安装的包，重新安装  </span>\nrpm -qa <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> webstatic\nrpm -e  <span class=\"token comment\"># 上面搜索到的包即可</span>\n</code></pre>\n<!--beforeend--></div><!--afterend--><p>3：fpm 安装 和 基本操作</p>\n<!--beforebegin--><div class=\"language-bash extra-class\"><!--afterbegin--><pre v-pre class=\"language-bash\"><code><span class=\"token comment\"># 也可以php55w-fpm  php70w-fpm</span>\n<span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> php56w-fpm \n\n<span class=\"token comment\"># 启动/重启/停止服务</span>\n<span class=\"token function\">service</span> php-fpm start/restart/stop\n</code></pre>\n<!--beforeend--></div><!--afterend--><p>4：安装PHP扩展</p>\n<!--beforebegin--><div class=\"language-bash extra-class\"><!--afterbegin--><pre v-pre class=\"language-bash\"><code><span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> php56w.x86_64 php56w-cli.x86_64 php56w-common.x86_64 php56w-gd.x86_64 php56w-mbstring.x86_64 php56w-mcrypt.x86_64 php56w-mysql.x86_64 php56w-pdo.x86_64\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"apache-基本操作\"><a class=\"header-anchor\" href=\"#apache-基本操作\" aria-hidden=\"true\">#</a> Apache 基本操作</h2>\n<ul>\n<li>yum install httpd 安装服务</li>\n<li>service httpd start 启动服务</li>\n<li>service httpd stop 停止服务</li>\n</ul>\n<h2 id=\"apache-虚拟主机和伪静态\"><a class=\"header-anchor\" href=\"#apache-虚拟主机和伪静态\" aria-hidden=\"true\">#</a> Apache 虚拟主机和伪静态</h2>\n<ul>\n<li>/etc/sysconfig/setlinux 将<code>SETLINUX=enforcing</code>改为<code>SETLINUX=disabled</code></li>\n<li>配置 Apache 虚拟主机示例，重启 Apache 服务</li>\n</ul>\n<!--beforebegin--><div class=\"language- extra-class\"><!--afterbegin--><pre v-pre class=\"language-text\"><code>&lt;VirtualHost *:80&gt;\n  ServerName test.com\n  DocumentRoot /data/www\n  &lt;Directory &quot;/data/www&quot;&gt;\n    Options Indexes FollowSymLinks\n    AllowOverride None\n    Require all granted\n    &lt;IfModule mod_rewrite.c&gt;\n      RewriteEngine On\n      RewriteRule ^(.*)\\.htm$ index.html\n    &lt;/IfWrite&gt;\n  &lt;/Directory&gt;\n&lt;/VirtualHost&gt;\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"nginx-基本操作\"><a class=\"header-anchor\" href=\"#nginx-基本操作\" aria-hidden=\"true\">#</a> nginx 基本操作</h2>\n<ul>\n<li>yum install nginx # 安装</li>\n<li>service nginx start # 启动</li>\n<li>service nginx stop # 停止</li>\n<li>service nginx reload # 重启</li>\n</ul>\n<h2 id=\"nginx-安装\"><a class=\"header-anchor\" href=\"#nginx-安装\" aria-hidden=\"true\">#</a> nginx 安装</h2>\n<ul>\n<li>sudo rpm -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm</li>\n<li>sudo yum install nginx</li>\n</ul>\n<h2 id=\"伪静态\"><a class=\"header-anchor\" href=\"#伪静态\" aria-hidden=\"true\">#</a> 伪静态</h2>\n<!--beforebegin--><div class=\"language- extra-class\"><!--afterbegin--><pre v-pre class=\"language-text\"><code>location / {\n  rewrite ^(.*)\\.htm$ /index.html;\n}\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"日志格式化\"><a class=\"header-anchor\" href=\"#日志格式化\" aria-hidden=\"true\">#</a> 日志格式化</h2>\n<!--beforebegin--><div class=\"language- extra-class\"><!--afterbegin--><pre v-pre class=\"language-text\"><code>log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;\n  &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;\n  &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;\n\naccess_log  /var/log/nginx/access.log  main;\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"反向代理和负载均衡\"><a class=\"header-anchor\" href=\"#反向代理和负载均衡\" aria-hidden=\"true\">#</a> 反向代理和负载均衡</h2>\n<!--beforebegin--><div class=\"language- extra-class\"><!--afterbegin--><pre v-pre class=\"language-text\"><code>upstream test_hosts {\n  server 118.89.106.129:80;\n  server 122.114.250.244:8082;\n}\n\nserver {\n    listen       80;\n    server_name  www.imooc.test;\n\n    location / {\n      proxy_pass http://test_hosts;\n    }\n}\n\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"nginx-php-通用配置\"><a class=\"header-anchor\" href=\"#nginx-php-通用配置\" aria-hidden=\"true\">#</a> nginx PHP 通用配置</h2>\n<!--beforebegin--><div class=\"language- extra-class\"><!--afterbegin--><pre v-pre class=\"language-text\"><code>server {\n  listen       80;\n  server_name  tp.com;\n  \n  root /data/www/tp/public;\n  index index.php index.html;\n  \n  access_log /var/log/nginx/access_tp.log main;\n\n  location / {\n    try_files $uri $uri/ /index.php?$args;\n  }\n\n  location ~ \\.php$ {\n    include fastcgi_params;\n    fastcgi_pass 127.0.0.1:9000;\n    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n    try_files $uri =404;\n  }   \n}\n\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"调试功能\"><a class=\"header-anchor\" href=\"#调试功能\" aria-hidden=\"true\">#</a> 调试功能</h2>\n<!--beforebegin--><div class=\"language- extra-class\"><!--afterbegin--><pre v-pre class=\"language-text\"><code>add_header Content-Type &quot;text/plain;charset=utf-8&quot;;\nreturn 200 &quot;$http_host&quot;\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"mysql-基本操作\"><a class=\"header-anchor\" href=\"#mysql-基本操作\" aria-hidden=\"true\">#</a> mysql 基本操作</h2>\n<ul>\n<li>yum install mysql-community-server 安装</li>\n<li>yum mysqld start/restart 启动</li>\n<li>yum mysqld stop 停止</li>\n</ul>\n<h2 id=\"mysql-安装\"><a class=\"header-anchor\" href=\"#mysql-安装\" aria-hidden=\"true\">#</a> mysql 安装</h2>\n<ul>\n<li>CentOS7 默认安装 mariadb 数据库</li>\n<li>yum remove mariadb-libs.x86_64</li>\n<li>https://dev.mysql.com.downloads/repo/yum/ 下载 mysql 源</li>\n<li>yum localinstall mysql57-community-release-el7-8.noarch.rpm</li>\n<li>yum install mysql-community-server 安装 mysql</li>\n<li>cat /var/log/mysqld/.log | grep &quot;password&quot; 查看默认密码</li>\n<li>mysql -uroot -pxxx 登陆 mysql 控制台</li>\n</ul>\n<p><strong>初次登陆控制台，无论输入什么命令都会提示重置密码</strong></p>\n<!--beforebegin--><div class=\"language-sql extra-class\"><!--afterbegin--><pre v-pre class=\"language-sql\"><code><span class=\"token comment\"># 设置密码为 123456</span>\n<span class=\"token keyword\">set</span> password <span class=\"token operator\">=</span> password<span class=\"token punctuation\">(</span><span class=\"token string\">'123456'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 设置密码校验规则</span>\n<span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password_policy<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> validate_password_length<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<!--beforeend--></div><!--afterend--><p>mysql 8.0.11  初始化密码使用，上面的方式不适用于 8.0.11 版本的 mysql</p>\n<!--beforebegin--><div class=\"language-sql extra-class\"><!--afterbegin--><pre v-pre class=\"language-sql\"><code><span class=\"token keyword\">ALTER</span> <span class=\"token keyword\">USER</span> <span class=\"token string\">'root'</span>@'localhost<span class=\"token string\">' IDENTIFIED BY '</span>MyNewPass'<span class=\"token punctuation\">;</span>\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"general-log-日志开启\"><a class=\"header-anchor\" href=\"#general-log-日志开启\" aria-hidden=\"true\">#</a> general_log 日志开启</h2>\n<!--beforebegin--><div class=\"language-sql extra-class\"><!--afterbegin--><pre v-pre class=\"language-sql\"><code><span class=\"token comment\"># 设置 general_log 文件存放位置</span>\n<span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> general_log_file<span class=\"token operator\">=</span><span class=\"token string\">\"/tmp/general.log\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\"># 开启 general_log</span>\n<span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> general_log<span class=\"token operator\">=</span><span class=\"token keyword\">on</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\"># 关闭 general_log</span>\n<span class=\"token keyword\">set</span> <span class=\"token keyword\">global</span> general_log<span class=\"token operator\">=</span><span class=\"token keyword\">off</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"用户操作\"><a class=\"header-anchor\" href=\"#用户操作\" aria-hidden=\"true\">#</a> 用户操作</h2>\n<!--beforebegin--><div class=\"language-sql extra-class\"><!--afterbegin--><pre v-pre class=\"language-sql\"><code><span class=\"token comment\"># 创建用户</span>\n<span class=\"token keyword\">create</span> <span class=\"token keyword\">user</span> <span class=\"token string\">'user'</span>@'<span class=\"token operator\">%</span><span class=\"token string\">' identified by '</span>password<span class=\"token string\">';\n\n# 给 user 用户赋予所有数据库的所有表的增删改查权限\ngrant all privileges on *.* to '</span><span class=\"token keyword\">user</span><span class=\"token string\">'@'</span><span class=\"token operator\">%</span><span class=\"token string\">' identified by '</span>password' <span class=\"token keyword\">with</span> <span class=\"token keyword\">grant</span> <span class=\"token keyword\">option</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\"># 移除用户 user 的权限</span>\n<span class=\"token keyword\">revoke</span> <span class=\"token keyword\">all</span> <span class=\"token keyword\">privileges</span> <span class=\"token keyword\">on</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">.</span><span class=\"token operator\">*</span> <span class=\"token keyword\">from</span> <span class=\"token keyword\">user</span><span class=\"token punctuation\">;</span>\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"免密码登陆\"><a class=\"header-anchor\" href=\"#免密码登陆\" aria-hidden=\"true\">#</a> 免密码登陆</h2>\n<ul>\n<li>/etc/my.cnf 加入一行<code>skip-grant-tables</code>，重启 mysqld 服务</li>\n</ul>\n</div>\n",null]}