{"remainingRequest":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/index.js??ref--1-1!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vuepress/lib/webpack/markdownLoader.js??ref--1-2!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/docs/thinkphp/basic.md?vue&type=template&id=7bbc0ca2&","dependencies":[{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/docs/thinkphp/basic.md","mtime":1543230166416},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/cache-loader/dist/cjs.js","mtime":1543230167140},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/loaders/templateLoader.js","mtime":1543230169205},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/cache-loader/dist/cjs.js","mtime":1543230167140},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/index.js","mtime":1543230169204},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vuepress/lib/webpack/markdownLoader.js","mtime":1543230169274}],"contextDependencies":[],"result":["\n<div class=\"content\"><h1 id=\"api常用知识\"><a class=\"header-anchor\" href=\"#api常用知识\" aria-hidden=\"true\">#</a> API常用知识</h1>\n<blockquote>\n<p>针对ThinkPHP5.0系列</p>\n</blockquote>\n<p><a href=\"http://www.thinkphp.cn\" target=\"_blank\" rel=\"noopener noreferrer\">官网<OutboundLink/></a>  <a href=\"https://www.kancloud.cn/manual/thinkphp5/118003\" target=\"_blank\" rel=\"noopener noreferrer\">文档<OutboundLink/></a></p>\n<h2 id=\"中断响应\"><a class=\"header-anchor\" href=\"#中断响应\" aria-hidden=\"true\">#</a> 中断响应</h2>\n<!--beforebegin--><div class=\"language-php extra-class\"><!--afterbegin--><pre v-pre class=\"language-php\"><code>\n<span class=\"token keyword\">use</span> <span class=\"token package\">think<span class=\"token punctuation\">\\</span>Response</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">think<span class=\"token punctuation\">\\</span>exception<span class=\"token punctuation\">\\</span>HttpResponseException</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * 【error】校验未通过，抛出异常\n */</span>\n<span class=\"token keyword\">protected</span> <span class=\"token keyword\">function</span> <span class=\"token function\">createResponse</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$code</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$msg</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">data</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'code'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$code</span><span class=\"token punctuation\">;</span>\n    <span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">data</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'msg'</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">=</span> <span class=\"token variable\">$msg</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token variable\">$response</span> <span class=\"token operator\">=</span> Response<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token property\">data</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpResponseException</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$response</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"格式化报错信息\"><a class=\"header-anchor\" href=\"#格式化报错信息\" aria-hidden=\"true\">#</a> 格式化报错信息</h2>\n<p>根目录/application/config.php</p>\n<!--beforebegin--><div class=\"language-php extra-class\"><!--afterbegin--><pre v-pre class=\"language-php\"><code>\n<span class=\"token comment\">// 异常页面的模板文件</span>\n<span class=\"token single-quoted-string string\">'exception_tmpl'</span>         <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token constant\">THINK_PATH</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">'tpl'</span> <span class=\"token punctuation\">.</span> <span class=\"token constant\">DS</span> <span class=\"token punctuation\">.</span> <span class=\"token single-quoted-string string\">'think_exception.tpl'</span><span class=\"token punctuation\">,</span>\n<span class=\"token comment\">// 错误显示信息,非调试模式有效</span>\n<span class=\"token single-quoted-string string\">'error_message'</span>          <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">,</span>\n<span class=\"token comment\">// 显示错误信息</span>\n<span class=\"token single-quoted-string string\">'show_error_msg'</span>         <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n<span class=\"token comment\">// 异常处理handle类 留空使用 \\think\\exception\\Handle</span>\n<span class=\"token single-quoted-string string\">'exception_handle'</span>       <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>Exception <span class=\"token variable\">$e</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'code'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'data'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token single-quoted-string string\">'msg'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$e</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n</code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"跨域访问\"><a class=\"header-anchor\" href=\"#跨域访问\" aria-hidden=\"true\">#</a> 跨域访问</h2>\n<p>添加文件：根目录/application/common/behavior/CronRun.php</p>\n<!--beforebegin--><div class=\"language-php extra-class\"><!--afterbegin--><pre v-pre class=\"language-php\"><code>\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">app<span class=\"token punctuation\">\\</span>common<span class=\"token punctuation\">\\</span>behavior</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">think<span class=\"token punctuation\">\\</span>Response</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * 跨域处理\n */</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CronRun</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token variable\">$dispatch</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$host_name</span> <span class=\"token operator\">=</span> <span class=\"token function\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'HTTP_ORIGIN'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'HTTP_ORIGIN'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">:</span> <span class=\"token double-quoted-string string\">\"*\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token variable\">$headers</span>   <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token double-quoted-string string\">\"Access-Control-Allow-Origin\"</span>      <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token variable\">$host_name</span><span class=\"token punctuation\">,</span>\n            <span class=\"token double-quoted-string string\">\"Access-Control-Allow-Credentials\"</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token single-quoted-string string\">'true'</span><span class=\"token punctuation\">,</span>\n            <span class=\"token double-quoted-string string\">\"Access-Control-Allow-Headers\"</span>     <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token double-quoted-string string\">\"auth,client-type,content-type,token\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$dispatch</span> <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$dispatch</span><span class=\"token operator\">-</span><span class=\"token operator\">></span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$headers</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'REQUEST_METHOD'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token variable\">$_SERVER</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'REQUEST_METHOD'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">===</span> <span class=\"token single-quoted-string string\">'OPTIONS'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$dispatch</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'type'</span><span class=\"token punctuation\">]</span>     <span class=\"token operator\">=</span> <span class=\"token single-quoted-string string\">'response'</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$response</span>             <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span><span class=\"token single-quoted-string string\">''</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$headers</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token variable\">$dispatch</span><span class=\"token punctuation\">[</span><span class=\"token single-quoted-string string\">'response'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$response</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n</span></code></pre>\n<!--beforeend--></div><!--afterend--><h2 id=\"路由重写\"><a class=\"header-anchor\" href=\"#路由重写\" aria-hidden=\"true\">#</a> 路由重写</h2>\n<!--beforebegin--><div class=\"language-php extra-class\"><!--afterbegin--><pre v-pre class=\"language-php\"><code>\n# 路由重写\n\n### Apache\n\n添加文件：根目录/.htaccess\n***********文件内容开始线(请勿复制该线)******************\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>IfModule</span> <span class=\"token attr-name\">mod_rewrite.c</span><span class=\"token punctuation\">></span></span>\nOptions +FollowSymlinks -Multiviews\nRewriteEngine on\n\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteRule ^(.*)$ index.php?/$1 [QSA,PT,L]\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>IfModule</span><span class=\"token punctuation\">></span></span>\n***********文件内容结束线(请勿复制该线)*******************\n\n### IIS\n\n添加文件：根目录/web.config\n***********文件内容开始线(请勿复制该线)******************\n<span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?</span>xml version<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"1.0\"</span> encoding<span class=\"token operator\">=</span><span class=\"token double-quoted-string string\">\"UTF-8\"</span><span class=\"token delimiter important\">?></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>configuration</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>system.webServer</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>rewrite</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>rules</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>rule</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>OrgPage<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">stopProcessing</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>match</span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>^(.*)$<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>conditions</span> <span class=\"token attr-name\">logicalGrouping</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>MatchAll<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>add</span> <span class=\"token attr-name\">input</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{HTTP_HOST}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">pattern</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>^(.*)$<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>add</span> <span class=\"token attr-name\">input</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{REQUEST_FILENAME}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">matchType</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>IsFile<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">negate</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>add</span> <span class=\"token attr-name\">input</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{REQUEST_FILENAME}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">matchType</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>IsDirectory<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">negate</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>true<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>conditions</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>action</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Rewrite<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">url</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>index.php/{R:1}<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>rule</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>rules</span><span class=\"token punctuation\">></span></span>\n     <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>rewrite</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>httpErrors</span> <span class=\"token attr-name\">errorMode</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>Detailed<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>system.webServer</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>configuration</span><span class=\"token punctuation\">></span></span>\n***********文件内容结束线(请勿复制该线)*******************\n\n</code></pre>\n<!--beforeend--></div><!--afterend--></div>\n",null]}