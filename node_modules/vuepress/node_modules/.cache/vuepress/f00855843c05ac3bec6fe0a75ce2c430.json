{"remainingRequest":"D:\\Products\\jianhaihao.github.io\\node_modules\\vue-loader\\lib\\loaders\\templateLoader.js??vue-loader-options!D:\\Products\\jianhaihao.github.io\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\Products\\jianhaihao.github.io\\node_modules\\vue-loader\\lib\\index.js??ref--1-1!D:\\Products\\jianhaihao.github.io\\node_modules\\vuepress\\lib\\webpack\\markdownLoader.js??ref--1-2!D:\\Products\\jianhaihao.github.io\\docs\\mysql\\colony.md?vue&type=template&id=76f3a470&","dependencies":[{"path":"D:\\Products\\jianhaihao.github.io\\docs\\mysql\\colony.md","mtime":1552483032816},{"path":"D:\\Products\\jianhaihao.github.io\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1552483034552},{"path":"D:\\Products\\jianhaihao.github.io\\node_modules\\vue-loader\\lib\\loaders\\templateLoader.js","mtime":1552483045256},{"path":"D:\\Products\\jianhaihao.github.io\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1552483034552},{"path":"D:\\Products\\jianhaihao.github.io\\node_modules\\vue-loader\\lib\\index.js","mtime":1552483045254},{"path":"D:\\Products\\jianhaihao.github.io\\node_modules\\vuepress\\lib\\webpack\\markdownLoader.js","mtime":1552483045520}],"contextDependencies":[],"result":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content\"},[_c('h1',{attrs:{\"id\":\"数据库集群\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#数据库集群\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" 数据库集群\")]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"单节点数据库弊端\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#单节点数据库弊端\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" 单节点数据库弊端\")]),_vm._v(\" \"),_c('blockquote',[_c('ul',[_c('li',[_vm._v(\"大型互联网程序用户群体庞大，架构必须要特殊设计\")]),_vm._v(\" \"),_c('li',[_vm._v(\"无法满足性能上的要求\")]),_vm._v(\" \"),_c('li',[_vm._v(\"没有冗余设计，无法满足高可用\")])])]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"常见mysql集群方案\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#常见mysql集群方案\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" 常见Mysql集群方案\")]),_vm._v(\" \"),_c('p',[_c('img',{attrs:{\"src\":\"/mysql-jq.jpg\",\"alt\":\"/mysql-jq.jpg\"}}),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"/mysql-jq-1.jpg\",\"alt\":\"/mysql-jq-1.jpg\"}}),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"/mysql-jq-2.jpg\",\"alt\":\"/mysql-jq-2.jpg\"}}),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"/mysql-jq-3.jpg\",\"alt\":\"/mysql-jq-3.jpg\"}}),_vm._v(\" \"),_c('img',{attrs:{\"src\":\"/mysql-jq-4.jpg\",\"alt\":\"/mysql-jq-4.jpg\"}})]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"创建集群\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#创建集群\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" 创建集群\")]),_vm._v(\" \"),_c('div',{staticClass:\"language-bash extra-class\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-bash\"}},[_c('code',[_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 拉取 pxc 镜像\")]),_vm._v(\"\\ndocker pull percona/percona-xtradb-cluster\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 查看已安装的镜像\")]),_vm._v(\"\\ndocker images\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"#######################分割线##################################\")]),_vm._v(\"\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 修改镜像名称（名称太长，不方便使用，选择性操作）\")]),_vm._v(\"\\ndocker tag percona/percona-xtradb-cluster pxc\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 删除旧的镜像\")]),_vm._v(\"\\ndocker rmi percona/percona-xtradb-cluster\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 查看已安装的镜像\")]),_vm._v(\"\\ndocker images\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"#######################分割线##################################\")]),_vm._v(\"\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"#（出于安全考虑，需要给pxc集群实例创建docker内部网络）\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# docker虚拟机自带的网段地址为：172.17.0.XXX\")]),_vm._v(\"\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 创建内部网段\")]),_vm._v(\"\\ndocker network create net1\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 查看内部网段\")]),_vm._v(\"\\ndocker network inspect net1   \"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# network可省略\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 删除内部网段\")]),_vm._v(\"\\ndocker network \"),_c('span',{pre:true,attrs:{\"class\":\"token function\"}},[_vm._v(\"rm\")]),_vm._v(\" net1\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 创建指定网段\")]),_vm._v(\"\\ndocker network create --subnet\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"172.18.0.0/24 net1\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# Docker容器使用原则：不要在容器里面保存业务数据！！！\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 要把业务数据保存到宿主机中，使用的技术是目录映射\")]),_vm._v(\"\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# pxc无法使用映射目录，可以采用docker卷来处理\")]),_vm._v(\"\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 容器中的pxc节点映射数据目录的解决办法\")]),_vm._v(\"\\ndocker volume create --name v1    \"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# --name可省略\")]),_vm._v(\"\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 查看数据卷在宿主机的真实路径\")]),_vm._v(\"\\ndocker inspect v1\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 删除数据卷\")]),_vm._v(\"\\ndocker volume \"),_c('span',{pre:true,attrs:{\"class\":\"token function\"}},[_vm._v(\"rm\")]),_vm._v(\" v1\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"#######################分割线##################################\")]),_vm._v(\"\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 向pxc镜像传入运行参数创建pxc容器\")]),_vm._v(\"\\ndocker run -d -p 3307:3306 -e MYSQL_ROOT_PASSWORD\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"yiyun2018 -e CLUSTER_NAME\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"PXC -e XTRABACKUP_PASSWORD\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"yiyun2018 -v v1:/var/lib/mysql --privileged --name\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"node1 --net\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"net1 --ip 172.18.0.2 pxc\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 创建第二个容器\")]),_vm._v(\"\\ndocker run -d -p 3308:3306 -e MYSQL_ROOT_PASSWORD\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"yiyun2018 -e CLUSTER_NAME\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"PXC -e XTRABACKUP_PASSWORD\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"yiyun2018 -e CLUSTER_JOIN\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"node1 -v v2:/var/lib/mysql --privileged --name\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"node2 --net\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"net1 --ip 172.18.0.3 pxc\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 创建第三个容器\")]),_vm._v(\"\\ndocker run -d -p 3309:3306 -e MYSQL_ROOT_PASSWORD\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"yiyun2018 -e CLUSTER_NAME\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"PXC -e XTRABACKUP_PASSWORD\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"yiyun2018 -e CLUSTER_JOIN\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"node1 -v v3:/var/lib/mysql --privileged --name\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"node3 --net\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"net1 --ip 172.18.0.4 pxc\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 创建第四个容器\")]),_vm._v(\"\\ndocker run -d -p 3310:3306 -e MYSQL_ROOT_PASSWORD\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"yiyun2018 -e CLUSTER_NAME\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"PXC -e XTRABACKUP_PASSWORD\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"yiyun2018 -e CLUSTER_JOIN\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"node1 -v v4:/var/lib/mysql --privileged --name\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"node4 --net\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"net1 --ip 172.18.0.5 pxc\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# 创建第五个容器\")]),_vm._v(\"\\ndocker run -d -p 3311:3306 -e MYSQL_ROOT_PASSWORD\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"yiyun2018 -e CLUSTER_NAME\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"PXC -e XTRABACKUP_PASSWORD\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"yiyun2018 -e CLUSTER_JOIN\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"node1 -v v5:/var/lib/mysql --privileged --name\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"node5 --net\"),_c('span',{pre:true,attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"net1 --ip 172.18.0.6 pxc\\n\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# -d 后台运行\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# -p [宿主机端口]:[容器端口]  把容器的3306端口映射到宿主机的3306端口\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# -v v1:/var/lib/mysql 路径映射，/var/lib/mysql 容器内的目录\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# -e MYSQL_ROOT_PASSWORD  参数，创建出的数据库实例的密码（用户名是root，不可修改）\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# -e MYSQL_ROOT_PASSWORD  参数，创建出的pxc集群的名字\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# -e MYSQL_ROOT_PASSWORD  参数，数据库节点之间同步使用的密码\")]),_vm._v(\"\\n\"),_c('span',{pre:true,attrs:{\"class\":\"token comment\"}},[_vm._v(\"# -e CLUSTER_JOIN  参数，和第一个节点容器进行同步\")]),_vm._v(\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\")])])])])}]\n\nexport { render, staticRenderFns }"]}