{"remainingRequest":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/index.js??ref--1-1!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vuepress/lib/webpack/markdownLoader.js??ref--1-2!/Users/jianhaihao/Documents/Products/jianhaihao.github.io/docs/nginx/https.md?vue&type=template&id=a1e5ca76&","dependencies":[{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/docs/nginx/https.md","mtime":1537408168000},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/cache-loader/dist/cjs.js","mtime":1537926131947},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/loaders/templateLoader.js","mtime":499162500000},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/cache-loader/dist/cjs.js","mtime":1537926131947},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jianhaihao/Documents/Products/jianhaihao.github.io/node_modules/vuepress/lib/webpack/markdownLoader.js","mtime":1533872387000}],"contextDependencies":[],"result":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content\"},[_c('h1',{attrs:{\"id\":\"nginx-https服务\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#nginx-https服务\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" Nginx HTTPS服务\")]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"准备工作\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#准备工作\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" 准备工作\")]),_vm._v(\" \"),_c('div',{staticClass:\"language-bash extra-class\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-bash\"}},[_c('code',[_vm._v(\"openssl version\\nnginx -V\\nrpm -qa \"),_c('span',{attrs:{\"class\":\"token operator\"}},[_vm._v(\"|\")]),_vm._v(\" \"),_c('span',{attrs:{\"class\":\"token function\"}},[_vm._v(\"grep\")]),_vm._v(\" openssl\\n\")])])]),_c('h2',{attrs:{\"id\":\"生成-key-csr-crt\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#生成-key-csr-crt\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" 生成 key,csr,crt\")]),_vm._v(\" \"),_c('div',{staticClass:\"language-bash extra-class\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-bash\"}},[_c('code',[_vm._v(\"openssl genrsa -idea -out hostname.key 1024\\nopenssl req -new -key hostname.key -out docs.csr\\nopenssl -req -days 3650 -in docs.csr -signkey docs.key -out docs.crt\\n\")])])]),_c('h2',{attrs:{\"id\":\"去掉-key-的密码\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#去掉-key-的密码\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" 去掉 key 的密码\")]),_vm._v(\" \"),_c('div',{staticClass:\"language-bash extra-class\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-bash\"}},[_c('code',[_vm._v(\"openssl rsa -in ./hostname.key -out ./hostname_nopwd.key\\n\")])])]),_c('h2',{attrs:{\"id\":\"直接通过-key-生成-crt\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#直接通过-key-生成-crt\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" 直接通过 key 生成 crt\")]),_vm._v(\" \"),_c('div',{staticClass:\"language-bash extra-class\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-bash\"}},[_c('code',[_vm._v(\"openssl req -days 36500 -x509 -sha256 -nodes -newkey rsa:2048 -keyout hostname.key -out hostname.crt\\n\")])])]),_c('h2',{attrs:{\"id\":\"nginx-的-https-的语法配置\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#nginx-的-https-的语法配置\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" Nginx 的 HTTPS 的语法配置\")]),_vm._v(\" \"),_c('p',[_vm._v(\"Syntax: ssl on | off;\\nDefault: ssl off;\\nContext: http, server\")]),_vm._v(\" \"),_c('p',[_vm._v(\"Syntax: ssl_centificate file;\\nDefault: --;\\nContext: http, server\")]),_vm._v(\" \"),_c('p',[_vm._v(\"Syntax: ssl_certificate_key file;\\nDefault: --;\\nContext: http, server\")]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"苹果证书要求\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#苹果证书要求\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" 苹果证书要求\")]),_vm._v(\" \"),_c('ul',[_c('li',[_vm._v(\"服务器所有的连接使用 TLS1.2 以上的版本 (openssl 1.0.2)\")]),_vm._v(\" \"),_c('li',[_vm._v(\"HTTPS 证书必须使用 SHA256 以上哈希算法签名\")]),_vm._v(\" \"),_c('li',[_vm._v(\"HTTPS 证书必须使用 RSA 2048 位或 ECC 256 位以上的公钥算法\")]),_vm._v(\" \"),_c('li',[_vm._v(\"使用前向加密技术\")])]),_vm._v(\" \"),_c('h2',{attrs:{\"id\":\"查看-crt-证书信息\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#查看-crt-证书信息\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" 查看 crt 证书信息\")]),_vm._v(\" \"),_c('div',{staticClass:\"language-bash extra-class\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-bash\"}},[_c('code',[_vm._v(\"openssl x509 -noout -text -in ./hostname.crt\\n\")])])]),_c('h2',{attrs:{\"id\":\"升级-openssl-脚本\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#升级-openssl-脚本\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" 升级 openssl 脚本\")]),_vm._v(\" \"),_c('div',{staticClass:\"language-bash extra-class\"},[_c('pre',{pre:true,attrs:{\"class\":\"language-bash\"}},[_c('code',[_c('span',{attrs:{\"class\":\"token shebang important\"}},[_vm._v(\"#!/bin/sh\")]),_vm._v(\"\\n\"),_c('span',{attrs:{\"class\":\"token function\"}},[_vm._v(\"cd\")]),_vm._v(\" /opt/download\\n\"),_c('span',{attrs:{\"class\":\"token function\"}},[_vm._v(\"wget\")]),_vm._v(\" https://www.openssl.org/source/openssl-1.0.2k.tar.gz\\n\"),_c('span',{attrs:{\"class\":\"token function\"}},[_vm._v(\"tar\")]),_vm._v(\" -zxvf open-ssl-1.0.2k.tar.gz\\n\"),_c('span',{attrs:{\"class\":\"token function\"}},[_vm._v(\"cd\")]),_vm._v(\" openssl-1.0.2k\\n./confg --prefix\"),_c('span',{attrs:{\"class\":\"token operator\"}},[_vm._v(\"=\")]),_vm._v(\"/usr/local/openssl\\n\"),_c('span',{attrs:{\"class\":\"token function\"}},[_vm._v(\"make\")]),_vm._v(\" \"),_c('span',{attrs:{\"class\":\"token operator\"}},[_vm._v(\"&&\")]),_vm._v(\" \"),_c('span',{attrs:{\"class\":\"token function\"}},[_vm._v(\"make\")]),_vm._v(\" \"),_c('span',{attrs:{\"class\":\"token function\"}},[_vm._v(\"install\")]),_vm._v(\"\\n\"),_c('span',{attrs:{\"class\":\"token function\"}},[_vm._v(\"mv\")]),_vm._v(\" /usr/bin/openssl  /usr/bin/openssl.OFF\\n\"),_c('span',{attrs:{\"class\":\"token function\"}},[_vm._v(\"ln\")]),_vm._v(\" -s /usr/local/openssl/bin/openssl  /usr/bin/openssl\\n\"),_c('span',{attrs:{\"class\":\"token function\"}},[_vm._v(\"ln\")]),_vm._v(\" -s /usr/local/openssl/include/openssl  /usr/include/openssl\\n\"),_c('span',{attrs:{\"class\":\"token keyword\"}},[_vm._v(\"echo\")]),_vm._v(\" \"),_c('span',{attrs:{\"class\":\"token string\"}},[_vm._v(\"\\\"/usr/local/openssl/lib\\\"\")]),_vm._v(\" \"),_c('span',{attrs:{\"class\":\"token operator\"}},[_vm._v(\">>\")]),_vm._v(\"/etc/ld.so.conf\\nldconfg -v\\nopenssl version -a\\n\")])])]),_c('h2',{attrs:{\"id\":\"https-优化\"}},[_c('a',{staticClass:\"header-anchor\",attrs:{\"href\":\"#https-优化\",\"aria-hidden\":\"true\"}},[_vm._v(\"#\")]),_vm._v(\" HTTPS 优化\")]),_vm._v(\" \"),_c('p',[_vm._v(\"https 连接建立 = tcp 握手 + ssl 握手\")]),_vm._v(\" \"),_c('ul',[_c('li',[_vm._v(\"激活 keepalive 长连接\"),_c('code',[_vm._v(\"keepalive_timeout 100;\")])]),_vm._v(\" \"),_c('li',[_vm._v(\"设置 ssl session 缓存\\n\"),_c('ul',[_c('li',[_c('code',[_vm._v(\"ssl_session_cache shared:SSL:10m;\")])]),_vm._v(\" \"),_c('li',[_c('code',[_vm._v(\"ssl_session_timeout 10m;\")])])])])])])}]\n\nexport { render, staticRenderFns }"]}